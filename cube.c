#include <stdio.h>
#include <string.h>
#include <time.h>
#include <stdlib.h>

#define CUBE_SIZE 48

/* char U[CUBE_SIZE] = { */
/*    5,  3,  0,  6,  1,  7,  4,  2, */
/*   32, 33, 34, 11, 12, 13, 14, 15, */
/*   16, 17, 18, 19, 20, 21, 22, 23, */
/*    8,  9, 10, 27, 28, 29, 30, 31, */
/*   40, 41, 42, 35, 36, 37, 38, 39, */
/*   24, 25, 26, 43, 44, 45, 46, 47 */
/* }; */
/*  */
/* char R[CUBE_SIZE] = { */
/*   0, 1, 10, 3, 12, 5, 6, 15, 8, 9, */
/*   18, 11, 20, 13, 14, 23, 16, 17, */
/*   45, 19, 43, 21, 22, 40, 24, 25, */
/*   26, 27, 28, 29, 30, 31, 37, 35, */
/*   32, 38, 33, 39, 36, 34, 7, 41, */
/*   42, 4, 44, 2, 46, 47 */
/* }; */
/*  */
/*  */
/* char L[CUBE_SIZE] = { */
/*   47, 1, 2, 44, 4, 42, 6, 7, 0, */
/*   9, 10, 3, 12, 5, 14, 15, 8, 17, */
/*   18, 11, 20, 13, 22, 23, 29, 27, */
/*   24, 30, 25, 31, 28, 26, 32, 33, */
/*   34, 35, 36, 37, 38, 39, 40, 41, */
/*   21, 43, 19, 45, 46, 16 */
/* }; */
/*  */
/* char D[CUBE_SIZE] = { */
/*   0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, */
/*   11, 12, 29, 30, 31, 21, 19, 16, */
/*   22, 17, 23, 20, 18, 24, 25, 26, */
/*   27, 28, 45, 46, 47, 32, 33, */
/*   34, 35, 36, 13, 14, 15, 40, 41, */
/*   42, 43, 44, 37, 38, 39 */
/* }; */
/*  */
/* char F[CUBE_SIZE] = { */
/*   0, 1, 2, 3, 4, 31, 28, 26, */
/*   13, 11, 8, 14, 9, 15, 12, 10, */
/*   37, 35, 32, 19, 20, 21, 22, 23, */
/*   24, 25, 16, 27, 17, 29, 30, 18, */
/*   5, 33, 34, 6, 36, 7, 38, 39, */
/*   40, 41, 42, 43, 44, 45, 46, 47 */
/* }; */
/*  */
/* char B[CUBE_SIZE] = { */
/*   34, 36, 39, 3, 4, 5, 6, 7, */
/*   8, 9, 10, 11, 12, 13, 14, 15, */
/*   16, 17, 18, 19, 20, 24, 27, 29, */
/*   2, 25, 26, 1, 28, 0, 30, 31, */
/*   32, 33, 23, 35, 22, 37, 38, 21, */
/*   45, 43, 40, 46, 41, 47, 44, 42 */
/* }; */

char S[CUBE_SIZE] = {
   0,  1,  2,  3,  4,  5,  6,  7,
   8,  9, 10, 11, 12, 13, 14, 15,
  16, 17, 18, 19, 20, 21, 22, 23,
  24, 25, 26, 27, 28, 29, 30, 31,
  32, 33, 34, 35, 36, 37, 38, 39,
  40, 41, 42, 43, 44, 45, 46, 47
};

char TRANSFORMATIONS[6][48] = {
{
   5,  3,  0,  6,  1,  7,  4,  2,
  32, 33, 34, 11, 12, 13, 14, 15,
  16, 17, 18, 19, 20, 21, 22, 23,
   8,  9, 10, 27, 28, 29, 30, 31,
  40, 41, 42, 35, 36, 37, 38, 39,
  24, 25, 26, 43, 44, 45, 46, 47
}, //UP
{
  0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,
  11, 12, 29, 30, 31, 21, 19, 16,
  22, 17, 23, 20, 18, 24, 25, 26,
  27, 28, 45, 46, 47, 32, 33,
  34, 35, 36, 13, 14, 15, 40, 41,
  42, 43, 44, 37, 38, 39
}, //DOWN
{
  47, 1, 2, 44, 4, 42, 6, 7, 0,
  9, 10, 3, 12, 5, 14, 15, 8, 17,
  18, 11, 20, 13, 22, 23, 29, 27,
  24, 30, 25, 31, 28, 26, 32, 33,
  34, 35, 36, 37, 38, 39, 40, 41,
  21, 43, 19, 45, 46, 16
}, //LEFT
{
  0, 1, 10, 3, 12, 5, 6, 15, 8, 9,
  18, 11, 20, 13, 14, 23, 16, 17,
  45, 19, 43, 21, 22, 40, 24, 25,
  26, 27, 28, 29, 30, 31, 37, 35,
  32, 38, 33, 39, 36, 34, 7, 41,
  42, 4, 44, 2, 46, 47
}, //RIGHT
{
  0, 1, 2, 3, 4, 31, 28, 26,
  13, 11, 8, 14, 9, 15, 12, 10,
  37, 35, 32, 19, 20, 21, 22, 23,
  24, 25, 16, 27, 17, 29, 30, 18,
  5, 33, 34, 6, 36, 7, 38, 39,
  40, 41, 42, 43, 44, 45, 46, 47
}, //FRONT
{
  34, 36, 39, 3, 4, 5, 6, 7,
  8, 9, 10, 11, 12, 13, 14, 15,
  16, 17, 18, 19, 20, 24, 27, 29,
  2, 25, 26, 1, 28, 0, 30, 31,
  32, 33, 23, 35, 22, 37, 38, 21,
  45, 43, 40, 46, 41, 47, 44, 42
} //BACK
};

void init_cube(char *cube, char *initial)
{
  int i = 0;
  while (i < CUBE_SIZE)
  {
    cube[i] = initial[i];
    i++;
  }
}

void apply_transform(char *cube, char *transform)
{
  char tmp[CUBE_SIZE];
  int i;
  for (i=0; i < CUBE_SIZE; i++)
   tmp[i] = cube[(int)transform[i]];
  memcpy(cube, tmp, CUBE_SIZE);
}


void print_cube(char *cube)
{
  int i = 0;
  while (i < CUBE_SIZE)
    printf("%d ", cube[i++]);
  printf("\n");
}

void print_U(char *cube)
{
  printf("%c%c%c\n%c%c%c\n%c%c%c\n", (cube[0] < 8 ? 'W' : ' '),
                                     (cube[1] < 8 ? 'W' : ' '),
                                     (cube[2] < 8 ? 'W' : ' '),
                                     (cube[3] < 8 ? 'W' : ' '),
                                     'W',
                                     (cube[4] < 8 ? 'W' : ' '),
                                     (cube[5] < 8 ? 'W' : ' '),
                                     (cube[6] < 8 ? 'W' : ' '),
                                     (cube[7] < 8 ? 'W' : ' '));
}


enum REPS { SINGLE, DOUBLE, TAG, REP_COUNT };
enum TWIST { UP, DOWN, LEFT, RIGHT, FRONT, BACK, TWIST_COUNT };
char TWIST_CHAR[6] = {'U', 'D', 'L', 'R', 'F', 'B'};
char REPS_CHAR[3] = {' ', '2', '\'' };

void gen_scramble(char *scramble, char *cube)
{
  int i, j;
  int si = 0;
  enum TWIST twist = TWIST_COUNT;
  enum TWIST prev = TWIST_COUNT;
  enum REPS reps;
  for (i=0; i < 20; i++)
  {
    while (twist == prev)
      twist = (rand() % TWIST_COUNT);
    prev = twist;
    reps = (rand() % REP_COUNT);
    scramble[si++] = TWIST_CHAR[twist];
    for (j=0; j <= reps; j++)
      apply_transform(cube, TRANSFORMATIONS[twist]);
    if (reps)  //Don't print anything if 1 rep
      scramble[si++] = REPS_CHAR[reps];
    scramble[si++] = ' ';
  }
  scramble[si] = '\0';
}

int main()
{
  char cube[CUBE_SIZE];
  char scramble[61];
  int i;
  srand((unsigned)time(NULL));
  for (i=0; i<15; i++)
  {
    init_cube(cube, S);
    gen_scramble(scramble, cube);
    print_U(cube);
    printf("%s\n", scramble);
  }
  return 0;
}



